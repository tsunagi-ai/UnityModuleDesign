@startuml
title Class Design of TsunagiModule

package TsunagiModule {
  class TsunagiBrain {
    Determine what the character should do
    +void ReceiveGoal(Goal goal)
    +void StartThink(delegate actionReceiver)
    +void ReceivePlayerMessage(string message)
    -Action NotifyActions()
    -GoapSolver goapSolver
    -State characterState
    -TsunagiConnection connector
  }
  TsunagiBrain "1" o-- "1" GoapSolver : Has >
  TsunagiBrain "1" o-- "1" State : Has as characterState >
  TsunagiBrain "1" o-- "1" TsunagiConnection : Has >
  
  class TsunagiConnection {
    Connects Unity and Server
    +SendReceivedMessage(string message, State state)
    +FetchAction(State state)
  }

  interface TsunagiCharacter {
    +void StartThink(State state)
    +delegate ReceiveActions(Action[] actionsList)
  }

  package Goap{
    class GoapSolver {
      Solver of GOAP problem
      +Action[] Solve(State goal, State current)
      +Action[] actionPool
    }
    GoapSolver ..> State : Uses >
    GoapSolver ..> Action : Uses >
    GoapSolver "1" o-- "*" Action : Has >

    abstract State{
      Vector of State
      +State Plus(State state)
      +float[] stateVector
      +Dictionary<string, int> indexNames
    }

    abstract Action {
      +ConditionSet precondition
      +State effectVector
      +float cost
      +string name
    }
    Action "1" o-- "1" State : Has >
    Action "1" o-- "1" ConditionSet : Has >

    abstract ConditionSet{
      Set of conditions for State
      +bool IsSatisfied(State state)
      +Condition[] conditions
    }
    ConditionSet "1" o-- "*" Condition : Has >

    abstract Condition{
      +string indexName
      +float value
      +ConditionOperator operator
    }
    Condition "1" o-- "1" ConditionOperator : Has >

    enum ConditionOperator {
      +Larger
      +Smaller
      +Equal
    }
  }
}

package Client{
  class Player {
  }

  class Character {
    +action()
  }

  class ChatInput {

  }
}

@enduml